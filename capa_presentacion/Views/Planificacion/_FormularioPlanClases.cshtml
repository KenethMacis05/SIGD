<style>
    /* CSS personalizado */
    .select2-hidden {
        opacity: 0;
        position: absolute;
        width: 1px;
        height: 1px;
    }

    .input-group .select2-container {
        flex: 1 1 auto;
    }

    .input-group .select2-selection {
        height: 100%;
    }

        .input-group .select2-selection:focus {
            border-color: #86b7fe;
            outline: 0;
            box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
        }
</style>

@model capa_entidad.PLANCLASESDIARIO

<div class="col-md-12">
    <div class="alert alert-warning d-flex align-items-center" role="alert">
        <i class="fas fa-info-circle me-2"></i>
        <div>
            Para generar un Plan de Clases Diario, seleccione la <strong>Asignatura.</strong> Los temas y contenidos asociados aparecerán automáticamente para su selección.
        </div>
    </div>
</div>

@using (Html.BeginForm("GuardarPlanDiario", "Planificacion", FormMethod.Post, new { @class = "card", @autocomplete = "off", @id = "formPlanClasesDiario", @novalidate = "novalidate" }))
{
    @Html.AntiForgeryToken()

    @Html.HiddenFor(m => m.id_plan_diario, new
    {
        id = "idPlan"
    })

    @Html.HiddenFor(m => m.id_encriptado_plan_didactico, new
    {
        id = "idEncriptadoPlanSemestral"
    })

    @Html.HiddenFor(m => m.fk_plan_didactico, new
{
    id = "fkPlanSemestral"
})

    <div class="card-header pb-0 border-bottom-0">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <button class="nav-link nav-link-tab active esp-link" id="generales-tab" data-bs-toggle="tab" data-bs-target="#generales" type="button" role="tab" aria-controls="generales" aria-selected="true">
                    Datos generales
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link nav-link-tab esp-link" id="competencias-tab" data-bs-toggle="tab" data-bs-target="#competencias" type="button" role="tab" aria-controls="competencias" aria-selected="false">
                    Competencias y Ejes
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link nav-link-tab esp-link" id="objetivos-tab" data-bs-toggle="tab" data-bs-target="#objetivos" type="button" role="tab" aria-controls="objetivos" aria-selected="false">
                    Objetivos
                </button>
            </li>
            <li class="nav-item">
                <button class="nav-link nav-link-tab esp-link" id="actividades-tab" data-bs-toggle="tab" data-bs-target="#actividades" type="button" role="tab" aria-controls="actividades" aria-selected="false">
                    Actividades
                </button>
            </li>
        </ul>
    </div>
    <div class="card-body overflow-auto" style="max-height: 45vh;">
        <div class="tab-content" id="myTabContent">
            <!--Datos generales-->
            <div class="tab-pane fade show active" id="generales" role="tabpanel" aria-labelledby="generales-tab">
                <div class="row mb-3">
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            @if (Model.id_plan_diario != 0)
                            {
                                <span class="input-group-text">Asignatura</span>
                                @Html.TextBoxFor(m => m.asignatura, new
                                {
                                    @class = "form-control",
                                    @disabled = "disabled"
                                })
                            }
                            else
                            {
                                <span class="input-group-text">Asignatura</span>
                                @Html.TextBoxFor(m => m.asignatura, new
                                {
                                    @class = "form-control",
                                    id = "asignaturaNombre",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('La asignatura es requerido')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "255"
                                })
                                <span class="input-group-text bg-primary text-white" onclick="abrirModal()"><i class="fa fa-search"></i></span>
                            }
                        </div>
                    </div>
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Nombre</span>
                            @Html.TextBoxFor(m => m.nombre, new
                            {
                                @class = "form-control",
                                required = "required",
                                @oninvalid = "this.setCustomValidity('El nombre es requerido')",
                                @oninput = "setCustomValidity('')",
                                maxlength = "255"
                            })
                        </div>
                    </div>
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Código</span>
                            @Html.TextBoxFor(m => m.codigo, new
                            {
                                @class = "form-control",
                                @disabled = "disabled"
                            })
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col col-md-6 col-sm-12">
                        <div class="input-group mb-3">
                            <label for="inputGroupSelectTemas" class="input-group-text">Tema</label>
                            <input type="hidden" name="fk_tema_activo" id="fk_tema_activo" value="@Model.fk_tema" />
                            @Html.DropDownListFor(m => m.fk_tema,
                              new SelectList(Enumerable.Empty<SelectListItem>(), "Value", "Text"),
                              "Seleccione un tema del plan didactico semestral...",
                              new
                              {
                                  @class = "form-select select2-hidden",
                                  required = "required",
                                  @oninvalid = "this.setCustomValidity('El tema es requerida')",
                                  @oninput = "setCustomValidity('')",
                                  id = "inputGroupSelectTemas"
                              })
                        </div>
                    </div>
                    <div class="col col-md-6 col-sm-12">
                        <div class="input-group mb-3">
                            <label for="inputGroupSelectContenido" class="input-group-text">Contenido(s)</label>
                            <input type="hidden" name="fk_plan_individual_activo" id="fk_plan_individual_activo" value="@Model.fk_plan_individual" />
                            @Html.DropDownListFor(m => m.fk_plan_individual,
                              new SelectList(Enumerable.Empty<SelectListItem>(), "Value", "Text"),
                              "Seleccione un contenido(s)...",
                              new
                              {
                                  @class = "form-select select2-hidden",
                                  required = "required",
                                  @oninvalid = "this.setCustomValidity('El contenido(s) es requerida')",
                                  @oninput = "setCustomValidity('')",
                                  id = "inputGroupSelectContenido"
                              })
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Profesor</span>
                            @Html.TextBoxFor(m => m.profesor, new
                            {
                                @class = "form-control",
                                id = "usuario",
                                @disabled = "disabled"
                            })
                        </div>
                    </div>
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Periodo</span>
                            @Html.TextBoxFor(m => m.periodo, new
                            {
                                @class = "form-control",
                                id = "periodo",
                                @disabled = "disabled"
                            })
                        </div>
                    </div>
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Inicio/Fin</span>
                            @{
                                var fechaInicioValue = Model?.fecha_inicio.ToString("yyyy-MM-dd");
                                var fechaFinValue = Model?.fecha_fin.ToString("yyyy-MM-dd");

                                if (fechaInicioValue == "0001-01-01")
                                {
                                    fechaInicioValue = DateTime.Today.ToString("yyyy-MM-dd");
                                }
                                if (fechaFinValue == "0001-01-01")
                                {
                                    fechaFinValue = DateTime.Today.AddDays(1).ToString("yyyy-MM-dd");
                                }
                            }

                            @Html.TextBoxFor(m => m.fecha_inicio, "{0:yyyy-MM-dd}", new
                            {
                                @type = "date",
                                @class = "form-control",
                                required = "required",
                                @oninvalid = "this.setCustomValidity('La fecha de inicio es requerida')",
                                @oninput = "setCustomValidity('')",
                                @Value = fechaInicioValue
                            })
                            <span class="input-group-text">a</span>
                            @Html.TextBoxFor(m => m.fecha_fin, "{0:yyyy-MM-dd}", new
                            {
                                @type = "date",
                                @class = "form-control",
                                required = "required",
                                @oninvalid = "this.setCustomValidity('La fecha de fin es requerida')",
                                @oninput = "setCustomValidity('')",
                                @Value = fechaFinValue
                            })
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Área de conocimiento</span>
                            @Html.TextBoxFor(m => m.area_conocimiento, new
                            {
                                @class = "form-control",
                                id = "areaConocimiento",
                                @disabled = "disabled"
                            })
                        </div>
                    </div>
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Departamento</span>
                            @Html.TextBoxFor(m => m.departamento, new
                            {
                                @class = "form-control",
                                id = "departamento",
                                @disabled = "disabled"
                            })
                        </div>
                    </div>
                    <div class="col col-md-4 col-sm-12">
                        <div class="input-group mb-3">
                            <span class="input-group-text">Carrera</span>
                            @Html.TextBoxFor(m => m.carrera, new
                            {
                                @class = "form-control",
                                id = "carrera",
                                @disabled = "disabled"
                            })
                        </div>
                    </div>
                </div>
            </div>

            <!--Competencias y Ejes-->
            <div class="tab-pane fade" id="competencias" role="tabpanel" aria-labelledby="competencias-tab">
                <div class="row">
                    <div class="col col-md-6 col-sm-12 mb-3">
                        <div class="card border-left-primary shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-lightbulb fa-lg text-primary me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">Competencias genericas</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.competencias_genericas, 5, 50, new
                                {
                                    @class = "form-control",
                                    id = "competenciasGenericasSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('Las competencias genericas son requeridas')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "1000"
                                })
                            </div>
                        </div>
                    </div>
                    <div class="col col-md-6 col-sm-12 mb-3">
                        <div class="card border-left-primary shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-lightbulb fa-lg text-primary me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">Competencias especificas</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.competencias_especificas, 5, 50, new
                                {
                                    @class = "form-control",
                                    id = "competenciasEspecificasSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('Las competencias especificas son requeridas')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "1000"
                                })
                            </div>
                        </div>
                    </div>
                </div>

                <hr />

                <div class="row">
                    <div class="col col-md-6 col-sm-12 mb-3">
                        <div class="card border-left-success shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-stream fa-lg text-success me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">Ejes</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.ejes, 3, 50, new
                                {
                                    @class = "form-control",
                                    id = "ejesSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('Los ejes son requeridos')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "1000"
                                })
                            </div>
                        </div>
                    </div>
                    <div class="col col-md-6 col-sm-12 mb-3">
                        <div class="card border-left-info shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-bullseye fa-lg text-info me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">BOA</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.BOA, 2, 50, new
                                {
                                    @class = "form-control",
                                    id = "boaSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('El BOA es requerido')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "500"
                                })
                            </div>
                        </div>
                    </div>
                </div>

                <hr />
            </div>

            <!--Objetivos y Contenidos-->
            <div class="tab-pane fade" id="objetivos" role="tabpanel" aria-labelledby="objetivos-tab">
                <div class="row">
                    <div class="col col-md-6 col-sm-12 mb-3">
                        <div class="card border-left-warning shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-bullseye fa-lg text-warning me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">Objetivo de Aprendizaje</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.objetivo_aprendizaje, 3, 50, new
                                {
                                    @class = "form-control",
                                    id = "objetivoSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('El objetivo de aprendizaje es requerido')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "500"
                                })
                            </div>
                        </div>
                    </div>
                    <div class="col col-md-6 col-sm-12 mb-3">
                        <div class="card border-left-dark shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-flag fa-lg text-dark me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">Indicador de Logro</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.indicador_logro, 2, 50, new
                                {
                                    @class = "form-control",
                                    id = "indicadorSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('El indicador de logro es requerido')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "300"
                                })
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--Actividades-->
            <div class="tab-pane fade" id="actividades" role="tabpanel" aria-labelledby="actividades-tab">
                <div class="row">
                    <div class="col col-md-12 col-sm-12 mb-3">
                        <div class="card border-left-success shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-play fa-lg text-success me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">Tareas Iniciales</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.tareas_iniciales, 2, 50, new
                                {
                                    @class = "form-control",
                                    id = "inicialesSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('Las tareas iniciales son requeridas')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "500"
                                })
                            </div>
                        </div>
                    </div>
                </div>

                <hr />

                <div class="row">
                    <div class="col col-md-12 col-sm-12 mb-3">
                        <div class="card border-left-primary shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-forward fa-lg text-primary me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">Tareas de Desarrollo</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.tareas_desarrollo, 2, 50, new
                                {
                                    @class = "form-control",
                                    id = "desarrolloSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('Las tareas de desarrollo son requeridas')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "1000"
                                })
                            </div>
                        </div>
                    </div>
                </div>

                <hr />

                <div class="row">
                    <div class="col col-md-12 col-sm-12 mb-3">
                        <div class="card border-left-info shadow-sm">
                            <div class="card-header">
                                <i class="fa fa-check fa-lg text-info me-2"></i>
                                <label class="form-label fs-5 fw-medium mb-0">Tareas de Síntesis</label>
                            </div>
                            <div class="card-body">
                                @Html.TextAreaFor(m => m.tareas_sintesis, 2, 50, new
                                {
                                    @class = "form-control",
                                    id = "sintesisSummernote",
                                    required = "required",
                                    @oninvalid = "this.setCustomValidity('Las tareas de síntesis son requeridas')",
                                    @oninput = "setCustomValidity('')",
                                    maxlength = "500"
                                })
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Controles de navegación en el footer -->
    <div class="card-footer text-center">
        <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-outline-danger" id="btnAnterior" style="display: none;">
                <i class="fa fa-arrow-left"></i>
            </button>

            <div>
                <a href="@Url.Action("Plan_de_Clases_Diario", "Planificacion")" class="btn btn-danger me-2">
                    <i class="fa fa-times"></i> Cancelar
                </a>
                <button type="submit" class="btn btn-primary" id="btnGuardar" style="display: none;">
                    <i class="fa fa-save"></i> @(Model.id_plan_diario == 0 ? "Guardar" : "Actualizar")
                </button>

                @if (Model.id_plan_diario != 0)
                {
                    <button type="submit" class="btn btn-primary" id="btnGuardar2">
                        <i class="fa fa-save"></i> Actualizar
                    </button>
                }
            </div>

            <button type="button" class="btn btn-outline-primary" id="btnSiguiente">
                <i class="fa fa-arrow-right"></i>
            </button>
        </div>
    </div>
}